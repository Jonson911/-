<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç„¦è™‘ç¼“è§£æ•ˆèƒ½è¿½è¸ªå™¨ v3.0</title>
    
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- å¼•å…¥ Phosphor Icons (ç”¨äºå›¾æ ‡) -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- é…ç½® Tailwind ä¸»é¢˜ï¼šä½¿ç”¨æŸ”å’Œçš„é¼ å°¾è‰ç»¿/é’è‰²è°ƒ -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        sage: {
                            50: '#f2fcf9',
                            100: '#dff9f0',
                            200: '#c0f0e0',
                            300: '#92e2cc',
                            400: '#5bcaba',
                            500: '#38b0a0', // ä¸»è‰²
                            600: '#2a8f83',
                            700: '#25736b',
                            800: '#215c56',
                        }
                    },
                    fontFamily: {
                        sans: ['"PingFang SC"', '"Microsoft YaHei"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* è‡ªå®šä¹‰æ»‘å—æ ·å¼ï¼Œä½¿å…¶çœ‹èµ·æ¥æ›´æŸ”å’Œ */
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%;
            background: #38b0a0; cursor: pointer; margin-top: -8px; 
            box-shadow: 0 2px 6px rgba(56, 176, 160, 0.4);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #e2e8f0; border-radius: 2px;
        }
        /* å»é™¤æ•°å­—è¾“å…¥æ¡†çš„ç®­å¤´ */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        /* æ¨¡æ€æ¡†èƒŒæ™¯ï¼Œç¡®ä¿å…¨å±è¦†ç›– */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.5); z-index: 50;
            display: flex; align-items: center; justify-content: center;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-600 font-sans min-h-screen pb-10">

    <!-- é¡¶éƒ¨ Header -->
    <header class="bg-white shadow-sm sticky top-0 z-10">
        <div class="max-w-3xl mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i class="ph-fill ph-heartbeat text-sage-500 text-2xl"></i>
                <div>
                    <h1 class="text-xl font-bold text-slate-700 tracking-tight leading-none">InnerCalm</h1>
                    <span class="text-[10px] text-slate-400 tracking-wider">ç”Ÿç†ä¸æƒ…ç»ªè¿½è¸ª v3.0</span>
                </div>
            </div>
            <button onclick="clearAllData()" class="text-xs text-slate-400 hover:text-red-400 transition-colors">
                é‡ç½®æ•°æ®
            </button>
        </div>
    </header>

    <main class="max-w-3xl mx-auto px-4 py-8 space-y-8">

        <!-- 1. è®°å½•è¯„ä¼°è¡¨å• -->
        <section class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
            <div class="bg-sage-50 px-6 py-3 border-b border-sage-100 flex items-center justify-between">
                <span class="font-semibold text-sage-800 text-sm flex items-center gap-2">
                    <i class="ph-bold ph-plus-circle"></i> æ–°çš„ç»ƒä¹ è®°å½•
                </span>
                <span class="text-xs text-sage-600" id="currentDate"></span>
            </div>
            
            <form id="trackerForm" class="p-6 space-y-8">
                
                <!-- æ–¹æ³•é€‰æ‹© -->
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-2">ä½¿ç”¨äº†ä»€ä¹ˆæ”¾æ¾æ–¹æ³•ï¼Ÿ</label>
                    <select id="methodSelect" class="w-full p-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-sage-500 focus:ring-1 focus:ring-sage-500 outline-none transition-all text-slate-700 cursor-pointer">
                        <option value="" disabled selected>--- è¯·é€‰æ‹©æ”¾æ¾æ–¹æ³• ---</option>
                        <!-- é’ˆå¯¹é«˜è¡€å‹/å¿ƒç‡çš„ç²¾ç¡®æ–¹æ³• -->
                        <optgroup label="ğŸ©º ç”Ÿç†è°ƒèŠ‚ç±»">
                            <option value="HRV åŒæ­¥å‘¼å¸æ³•">âœ… HRV åŒæ­¥å‘¼å¸æ³• (æ¨èé™å‹)</option>
                            <option value="æ¸è¿›å¼è‚Œè‚‰æ”¾æ¾ (PMR)">ğŸ’ª æ¸è¿›å¼è‚Œè‚‰æ”¾æ¾ (PMR)</option>
                        </optgroup>
                        <!-- ç»¼åˆè°ƒèŠ‚ç±» -->
                        <optgroup label="ğŸ§  å¿ƒç†è°ƒèŠ‚ç±»">
                            <option value="æ­£å¿µå†¥æƒ³">ğŸ§˜ æ­£å¿µå†¥æƒ³</option>
                            <option value="å¼•å¯¼å¼æ„è±¡è®­ç»ƒ">ğŸï¸ å¼•å¯¼å¼æ„è±¡è®­ç»ƒ</option>
                            <option value="è‡ªæˆ‘æ”¾æ¾è®­ç»ƒ">ğŸ˜´ è‡ªæˆ‘æ”¾æ¾è®­ç»ƒ</option>
                            <option value="ä¹¦å†™ç–—æ„ˆ">âœï¸ ä¹¦å†™ç–—æ„ˆ</option>
                        </optgroup>
                        <!-- èº«ä½“è¿åŠ¨ç±» -->
                        <optgroup label="ğŸƒ èº«ä½“è¿åŠ¨ç±»">
                            <option value="å¤ªæ/æ°”åŠŸ">â˜¯ï¸ å¤ªæ/æ°”åŠŸ</option>
                            <option value="ç‘œä¼½">ğŸ¤¸ ç‘œä¼½ (èˆ’ç¼“å¼)</option>
                            <option value="æœ‰æ°§è¿åŠ¨">ğŸƒ æœ‰æ°§è¿åŠ¨ (è½»åº¦)</option>
                        </optgroup>
                        <option value="å¬éŸ³ä¹">ğŸ§ å¬éŸ³ä¹</option>
                        <option value="4-7-8 å‘¼å¸æ³•">ğŸŒ¬ï¸ 4-7-8 å‘¼å¸æ³• (å¿«é€Ÿé•‡é™)</option>
                        <option value="other">âœ¨ å…¶ä»–...</option>
                    </select>
                    <input type="text" id="customMethodInput" class="mt-2 w-full p-3 rounded-xl bg-white border border-slate-200 focus:border-sage-500 outline-none hidden" placeholder="è¯·è¾“å…¥ä½ çš„æ–¹æ³•åç§°">
                </div>

                <!-- å¯¹æ¯”åŒºåŸŸï¼šBEFORE vs AFTER -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 relative">
                    <!-- åˆ†éš”çº¿ (æ¡Œé¢ç«¯) -->
                    <div class="hidden md:block absolute left-1/2 top-0 bottom-0 w-px bg-slate-100 -ml-px"></div>

                    <!-- Relax Before (æ”¾æ¾å‰) -->
                    <div class="space-y-6">
                        <div class="flex items-center gap-2 pb-2 border-b border-slate-100">
                            <span class="w-2.5 h-2.5 rounded-full bg-slate-400"></span> 
                            <h3 class="font-bold text-slate-700">æ”¾æ¾å‰ (Before)</h3>
                        </div>
                        
                        <!-- ç„¦è™‘åº¦æ»‘å— -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-xs font-bold text-slate-500 uppercase">ä¸»è§‚ç„¦è™‘ (SUDs) 0-10</label>
                                <span class="text-lg font-bold text-slate-600 leading-none" id="val-anxiety-before">5</span>
                            </div>
                            <input type="range" id="anxietyBefore" min="0" max="10" value="5" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                        </div>

                        <!-- ç”Ÿç†æŒ‡æ ‡ç»„ (å¿ƒç‡, è¡€å‹) -->
                        <div class="bg-slate-50 p-4 rounded-xl space-y-4">
                            <div class="text-xs font-bold text-slate-400 uppercase tracking-wider mb-1">ç”Ÿç†æŒ‡æ ‡ (é€‰å¡«)</div>
                            
                            <!-- å¿ƒç‡ -->
                            <div class="flex items-center justify-between gap-4">
                                <label class="text-sm text-slate-600 min-w-[40px] flex items-center gap-1"><i class="ph ph-heartbeat text-red-500"></i> å¿ƒç‡</label>
                                <div class="relative w-full">
                                    <input type="number" id="hrBefore" placeholder="BPM" class="w-full p-2 pr-8 text-right rounded-lg border border-slate-200 text-sm focus:border-sage-400 outline-none bg-white">
                                    <span class="absolute right-2 top-2 text-xs text-slate-400">æ¬¡/åˆ†</span>
                                </div>
                            </div>

                            <!-- è¡€å‹ -->
                            <div class="flex items-center justify-between gap-2">
                                <label class="text-sm text-slate-600 min-w-[40px] flex items-center gap-1"><i class="ph ph-hand-tap text-blue-500"></i> è¡€å‹</label>
                                <div class="flex gap-2 w-full">
                                    <input type="number" id="bpSysBefore" placeholder="æ”¶ç¼©å‹" class="w-1/2 p-2 text-center rounded-lg border border-slate-200 text-sm focus:border-sage-400 outline-none bg-white">
                                    <span class="text-slate-300 pt-1">/</span>
                                    <input type="number" id="bpDiaBefore" placeholder="èˆ’å¼ å‹" class="w-1/2 p-2 text-center rounded-lg border border-slate-200 text-sm focus:border-sage-400 outline-none bg-white">
                                </div>
                                <span class="text-slate-300 pt-1 text-xs">mmHg</span>
                            </div>
                        </div>
                    </div>

                    <!-- Relax After (æ”¾æ¾å) -->
                    <div class="space-y-6">
                        <div class="flex items-center gap-2 pb-2 border-b border-slate-100">
                            <span class="w-2.5 h-2.5 rounded-full bg-sage-500"></span> 
                            <h3 class="font-bold text-sage-700">æ”¾æ¾å (After)</h3>
                        </div>
                        
                        <!-- ç„¦è™‘åº¦æ»‘å— -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-xs font-bold text-slate-500 uppercase">ä¸»è§‚ç„¦è™‘ (SUDs) 0-10</label>
                                <span class="text-lg font-bold text-sage-600 leading-none" id="val-anxiety-after">3</span>
                            </div>
                            <input type="range" id="anxietyAfter" min="0" max="10" value="3" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-sage-500">
                        </div>

                        <!-- ç”Ÿç†æŒ‡æ ‡ç»„ (å¿ƒç‡, è¡€å‹) -->
                        <div class="bg-sage-50/50 p-4 rounded-xl space-y-4 border border-sage-100">
                            <div class="text-xs font-bold text-sage-400 uppercase tracking-wider mb-1">ç”Ÿç†æŒ‡æ ‡ (é€‰å¡«)</div>
                            
                            <!-- å¿ƒç‡ -->
                            <div class="flex items-center justify-between gap-4">
                                <label class="text-sm text-slate-600 min-w-[40px] flex items-center gap-1"><i class="ph ph-heartbeat text-red-500"></i> å¿ƒç‡</label>
                                <div class="relative w-full">
                                    <input type="number" id="hrAfter" placeholder="BPM" class="w-full p-2 pr-8 text-right rounded-lg border border-sage-200 text-sm focus:border-sage-400 focus:ring-1 focus:ring-sage-400 outline-none bg-white">
                                    <span class="absolute right-2 top-2 text-xs text-slate-400">æ¬¡/åˆ†</span>
                                </div>
                            </div>

                            <!-- è¡€å‹ -->
                            <div class="flex items-center justify-between gap-2">
                                <label class="text-sm text-slate-600 min-w-[40px] flex items-center gap-1"><i class="ph ph-hand-tap text-blue-500"></i> è¡€å‹</label>
                                <div class="flex gap-2 w-full">
                                    <input type="number" id="bpSysAfter" placeholder="æ”¶ç¼©å‹" class="w-1/2 p-2 text-center rounded-lg border border-sage-200 text-sm focus:border-sage-400 focus:ring-1 focus:ring-sage-400 outline-none bg-white">
                                    <span class="text-slate-300 pt-1">/</span>
                                    <input type="number" id="bpDiaAfter" placeholder="èˆ’å¼ å‹" class="w-1/2 p-2 text-center rounded-lg border border-sage-200 text-sm focus:border-sage-400 focus:ring-1 focus:ring-sage-400 outline-none bg-white">
                                </div>
                                <span class="text-slate-300 pt-1 text-xs">mmHg</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å¤‡æ³¨ (é€‰å¡«) -->
                <div>
                    <label class="text-xs font-bold text-slate-500 uppercase tracking-wide block mb-1">å¤‡æ³¨ / æ„Ÿå— (å¯é€‰)</label>
                    <textarea id="notes" rows="2" class="w-full p-3 rounded-xl bg-slate-50 border-none text-sm focus:ring-1 focus:ring-sage-300 resize-none placeholder-slate-400" placeholder="è®°å½•ä¸‹æ­¤åˆ»çš„æƒ³æ³•ï¼Œæˆ–è€…èº«ä½“çš„å…·ä½“æ„Ÿå—..."></textarea>
                </div>

                <!-- æäº¤æŒ‰é’® -->
                <button type="submit" class="w-full bg-sage-500 hover:bg-sage-600 text-white font-bold py-4 rounded-xl transition-all transform active:scale-[0.99] shadow-lg shadow-sage-200 flex justify-center items-center gap-2 text-base">
                    <i class="ph-bold ph-check-circle text-xl"></i>
                    è®°å½•å¹¶åˆ†æ
                </button>
            </form>
        </section>

        <!-- 2. æ™ºèƒ½åˆ†æä»ªè¡¨ç›˜ -->
        <section id="dashboardSection" class="space-y-8 hidden">
            
            <!-- æ•ˆèƒ½æ’è¡Œæ¦œ -->
            <div>
                <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <i class="ph-fill ph-trophy text-yellow-400"></i> æœ€ä½³å‡å‹æ–¹æ³• Top 3
                </h3>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4" id="leaderboardContainer">
                    <!-- JS åŠ¨æ€æ’å…¥æ’è¡Œæ¦œå¡ç‰‡ -->
                </div>
            </div>

            <!-- è¶‹åŠ¿å›¾è¡¨ -->
            <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h3 class="font-bold text-slate-700">ç„¦è™‘ç¨‹åº¦å˜åŒ–è¶‹åŠ¿ (SUDs)</h3>
                        <p class="text-xs text-slate-400">è¶Šä½ä»£è¡¨è¶Šå¹³é™</p>
                    </div>
                    <div class="flex gap-4 text-xs font-medium">
                        <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-slate-300"></span>æ”¾æ¾å‰</span>
                        <span class="flex items-center gap-1.5"><span class="w-2.5 h-2.5 rounded-full bg-sage-500"></span>æ”¾æ¾å</span>
                    </div>
                </div>
                <div class="h-64 w-full">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>
        </section>

        <!-- 3. è¯¦ç»†å†å²è®°å½• -->
        <section id="historySection" class="hidden">
            <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                <i class="ph-fill ph-clock-counter-clockwise text-slate-400"></i> è¯¦ç»†è®°å½•
            </h3>
            <div id="historyList" class="space-y-4">
                <!-- JS åŠ¨æ€æ’å…¥å†å²è®°å½•å¡ç‰‡ -->
            </div>
        </section>

        <!-- ç©ºçŠ¶æ€æç¤º -->
        <div id="emptyState" class="text-center py-16 opacity-60">
            <div class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="ph-duotone ph-notebook text-3xl text-slate-400"></i>
            </div>
            <p class="text-slate-500 font-medium">æš‚æ— æ•°æ®</p>
            <p class="text-xs text-slate-400 mt-1">å®Œæˆç¬¬ä¸€æ¬¡ç»ƒä¹ æ¥æŸ¥çœ‹åˆ†æ</p>
        </div>

    </main>

    <!-- æ–¹æ³•æŒ‡å¯¼æ¨¡æ€æ¡† (Modal) -->
    <div id="instructionModal" class="modal-overlay hidden">
        <div class="bg-white rounded-2xl shadow-2xl p-6 w-11/12 max-w-lg transform transition-all duration-300">
            <h3 id="modalTitle" class="text-2xl font-bold text-sage-600 mb-4 flex items-center gap-2 border-b pb-2 border-slate-100">
                <!-- Title is inserted here -->
            </h3>
            
            <div class="max-h-[70vh] overflow-y-auto pr-2">
                <div class="space-y-4" id="modalSteps">
                    <!-- Steps are inserted here -->
                </div>
                <div class="mt-4 p-3 bg-slate-50 rounded-lg border border-slate-100">
                    <p class="text-sm font-semibold text-slate-700 mb-1">åŸç†æç¤ºï¼š</p>
                    <p id="modalTip" class="text-xs text-slate-500"></p>
                </div>
            </div>

            <button onclick="hideInstructions()" class="mt-6 w-full bg-slate-200 hover:bg-slate-300 text-slate-700 font-medium py-3 rounded-xl transition-colors">
                æˆ‘å·²äº†è§£ï¼Œå¼€å§‹ç»ƒä¹ 
            </button>
        </div>
    </div>

    <script>
        // --- æ ¸å¿ƒæ•°æ®ï¼šæ–¹æ³•æŒ‡å¯¼ ---
        const MethodInstructions = {
            '4-7-8 å‘¼å¸æ³•': {
                title: '4-7-8 å‘¼å¸æ³•',
                steps: [
                    '1. å®Œå…¨å‘¼æ°”ï¼Œå°†è‚ºéƒ¨çš„ç©ºæ°”æ’ç©ºã€‚',
                    '2. é—­å˜´ï¼Œç”¨é¼»å­å¸æ°”ï¼Œé»˜æ•° 4 ç§’ã€‚',
                    '3. å±ä½å‘¼å¸ï¼Œé»˜æ•° 7 ç§’ã€‚',
                    '4. å¼ å¼€å˜´å·´ï¼Œå‘å‡ºâ€œå‘¼â€å£°ï¼Œå‘¼æ°” 8 ç§’ã€‚',
                    '5. é‡å¤ 3-4 æ¬¡ã€‚'
                ],
                tip: 'æ­¤æ³•èƒ½å¿«é€Ÿæ¿€æ´»å‰¯äº¤æ„Ÿç¥ç»ï¼Œå¸®åŠ©é™å‹å’Œå‡ç¼“å¿ƒç‡ã€‚'
            },
            'æ¸è¿›å¼è‚Œè‚‰æ”¾æ¾ (PMR)': {
                title: 'æ¸è¿›å¼è‚Œè‚‰æ”¾æ¾ (PMR)',
                steps: [
                    '1. æ‰¾åˆ°èˆ’é€‚çš„å§¿åŠ¿ï¼Œä»è„šå°–æˆ–æ‰‹éƒ¨å¼€å§‹ã€‚',
                    '2. ç´§ç»·ä¸€ç»„è‚Œè‚‰ï¼ˆå¦‚å³æ‹³ï¼‰ï¼ŒæŒç»­ 5-10 ç§’ã€‚',
                    '3. å¿«é€Ÿæ”¾æ¾ï¼Œæ„Ÿå—ç´§ç»·ä¸æ¾å¼›ä¹‹é—´çš„å·¨å¤§å·®å¼‚ï¼ŒæŒç»­ 20 ç§’ã€‚',
                    '4. ä¾æ¬¡æ”¾æ¾å…¨èº«æ‰€æœ‰è‚Œè‚‰ç¾¤ã€‚'
                ],
                tip: 'é€šè¿‡æœ‰æ„è¯†çš„æ”¶ç´§å†æ”¾æ¾ï¼Œæ¶ˆé™¤è‚Œè‚‰æ·±å±‚ç´§å¼ ï¼Œæœ‰æ•ˆç¼“è§£èº¯ä½“åŒ–ç„¦è™‘ã€‚'
            },
            'æ­£å¿µå†¥æƒ³': {
                title: 'æ­£å¿µå†¥æƒ³',
                steps: [
                    '1. æ‰¾ä¸€ä¸ªå®‰é™çš„åœ°æ–¹åä¸‹ã€‚',
                    '2. é—­ä¸Šçœ¼ç›ï¼Œå°†æ³¨æ„åŠ›é›†ä¸­åœ¨å‘¼å¸ä¸Šã€‚',
                    '3. å½“æ€ç»ªé£˜èµ°æ—¶ï¼Œæ¸©æŸ”åœ°å°†å…¶å¸¦å›å‘¼å¸ã€‚',
                    '4. æŒç»­ 10-20 åˆ†é’Ÿï¼Œä¸å¸¦è¯„åˆ¤åœ°è§‚å¯Ÿå½“ä¸‹çš„æ„Ÿå—ã€‚'
                ],
                tip: 'åŸ¹å…»å¯¹å½“ä¸‹çŠ¶æ€çš„è§‰çŸ¥ï¼Œå‡å°‘å¯¹æœªæ¥ä¸ç¡®å®šæ€§çš„æ‹…å¿§ã€‚'
            },
            'ç‘œä¼½': {
                title: 'ç‘œä¼½ (èˆ’ç¼“å¼)',
                steps: [
                    '1. é€‰æ‹©å‡ ä¸ªæ¸©å’Œçš„ä½“å¼ï¼ˆå¦‚çŒ«ç‰›å¼ã€å©´å„¿å¼ã€ä»°å§æ‰­è½¬ï¼‰ã€‚',
                    '2. æ¯ä¸ªä½“å¼åœç•™ 1-3 åˆ†é’Ÿã€‚',
                    '3. é…åˆæ·±é•¿å‡åŒ€çš„å‘¼å¸ï¼Œé‡ç‚¹æ”¾åœ¨æ‹‰ä¼¸å’Œæ”¾æ¾ã€‚'
                ],
                tip: 'è¿åŠ¨ä¸å‘¼å¸ç»“åˆï¼Œå¯ä»¥å¸®åŠ©è°ƒèŠ‚è¡€å‹å’Œæ”¹å–„è¡€æ¶²å¾ªç¯ã€‚'
            },
            'æœ‰æ°§è¿åŠ¨': {
                title: 'æœ‰æ°§è¿åŠ¨ (è½»åº¦)',
                steps: [
                    '1. é€‰æ‹©ä½å¼ºåº¦ã€æŒç»­æ€§çš„è¿åŠ¨ï¼Œå¦‚å¿«èµ°ã€æ…¢è·‘æˆ–éª‘è‡ªè¡Œè½¦ã€‚',
                    '2. ä¿æŒå¿ƒç‡åœ¨æœ€å¤§å¿ƒç‡çš„ 50%-70%ã€‚',
                    '3. æŒç»­ 20-30 åˆ†é’Ÿã€‚'
                ],
                tip: 'è§„å¾‹çš„æœ‰æ°§è¿åŠ¨æ˜¯æ”¹å–„æ…¢æ€§ç„¦è™‘å’Œé«˜è¡€å‹çš„é•¿æœŸæœ‰æ•ˆæ‰‹æ®µã€‚'
            },
            'ä¹¦å†™ç–—æ„ˆ': {
                title: 'ä¹¦å†™ç–—æ„ˆ',
                steps: [
                    '1. æ‰¾ä¸€ä¸ªç¬”è®°æœ¬å’Œç¬”ï¼Œç»™è‡ªå·± 15 åˆ†é’Ÿä¸å—æ‰“æ‰°çš„æ—¶é—´ã€‚',
                    '2. å†™ä¸‹ä½ æ‰€æœ‰ç„¦è™‘ã€ææƒ§æˆ–çƒ¦æ¼ï¼Œä¸è¦è¯„åˆ¤ï¼Œåªç®¡å€¾æ³»ã€‚',
                    '3. å®Œæˆåï¼Œå¯ä»¥é€‰æ‹©æ’•æ¯æˆ–é”èµ·æ¥ã€‚'
                ],
                tip: 'å°†å†…åœ¨æƒ…ç»ªå¤–åŒ–ï¼Œå¸®åŠ©ç†æ¸…æ€ç»ªï¼Œå‡å°‘å†…åœ¨å‹åŠ›å¯¹èº«ä½“çš„ä¾µèš€ã€‚'
            },
            'å¬éŸ³ä¹': {
                title: 'å¬éŸ³ä¹ (æ”¾æ¾)',
                steps: [
                    '1. é€‰æ‹©èŠ‚å¥ç¼“æ…¢ï¼ˆä½äº 60 BPMï¼‰ã€æ²¡æœ‰æ­Œè¯çš„çº¯éŸ³ä¹ï¼ˆå¦‚å¤å…¸ä¹ã€è‡ªç„¶éŸ³æ™¯ï¼‰ã€‚',
                    '2. è°ƒä½éŸ³é‡ï¼Œä»¥èˆ’é€‚ä¸ºä¸»ã€‚',
                    '3. é—­ä¸Šçœ¼ç›ï¼Œä¸“æ³¨å¬è§‰æ„Ÿå—ã€‚'
                ],
                tip: 'ç‰¹å®šçš„éŸ³ä¹é¢‘ç‡å·²è¢«è¯æ˜èƒ½æœ‰æ•ˆè¯±å¯¼ Alpha æ³¢ï¼Œå¸®åŠ©èº«ä½“è¿›å…¥æ”¾æ¾çŠ¶æ€ã€‚'
            },
            'HRV åŒæ­¥å‘¼å¸æ³•': {
                title: 'HRV åŒæ­¥å‘¼å¸æ³•',
                steps: [
                    '1. æ‰¾ä¸€ä¸ªèˆ’é€‚çš„åå§¿ï¼Œå°†æ‰‹æ”¾åœ¨è…¹éƒ¨ã€‚',
                    '2. å°è¯•ç”¨é¼»å­è¿›è¡Œè…¹å¼å‘¼å¸ã€‚',
                    '3. å…³é”®ï¼šå¸æ°” 5 ç§’ï¼Œå‘¼æ°” 5 ç§’ã€‚ä½¿æ¯åˆ†é’Ÿå‘¼å¸æ¬¡æ•°ç¨³å®šåœ¨ 6 æ¬¡ã€‚',
                    '4. æŒç»­ 10-20 åˆ†é’Ÿï¼Œä¿æŒèŠ‚å¥çš„ç¨³å®šæ€§å’Œå¹³æ»‘åº¦ã€‚'
                ],
                tip: 'è¿™æ˜¯æé«˜å¿ƒç‡å˜å¼‚æ€§(HRV)æœ€æœ‰æ•ˆçš„æ–¹æ³•ä¹‹ä¸€ï¼Œç›´æ¥è°ƒèŠ‚è‡ªä¸»ç¥ç»ç³»ç»Ÿï¼Œå¯¹ç„¦è™‘æ€§é«˜è¡€å‹æœ‰æ˜¾è‘—çš„è¾…åŠ©ä½œç”¨ã€‚'
            },
            'å¼•å¯¼å¼æ„è±¡è®­ç»ƒ': {
                title: 'å¼•å¯¼å¼æ„è±¡è®­ç»ƒ',
                steps: [
                    '1. æ’­æ”¾ä¸€æ®µå¼•å¯¼å¼æ„è±¡çš„éŸ³é¢‘ï¼Œæˆ–è‡ªå·±æƒ³è±¡ã€‚',
                    '2. é—­ä¸Šçœ¼ç›ï¼Œæƒ³è±¡è‡ªå·±èº«å¤„ä¸€ä¸ªæœ€å®‰å…¨ã€æœ€å¹³é™çš„ç¯å¢ƒï¼ˆå¦‚æ¸©æš–çš„æ²™æ»©æˆ–å®é™çš„æ£®æ—ï¼‰ã€‚',
                    '3. ä¸“æ³¨äºç»†èŠ‚ï¼šæ„Ÿå—é˜³å…‰çš„æ¸©åº¦ã€å¬åˆ°æµ·æµªçš„å£°éŸ³ã€é—»åˆ°æ³¥åœŸçš„èŠ¬èŠ³ã€‚'
                ],
                tip: 'é€šè¿‡æƒ³è±¡åŠ›åˆ‡æ–­ç„¦è™‘å›è·¯ï¼Œè®©å¤§è„‘äº§ç”Ÿæ”¾æ¾æ¿€ç´ ï¼Œé—´æ¥å¸®åŠ©è¡€ç®¡æ”¾æ¾ã€‚'
            },
            'è‡ªæˆ‘æ”¾æ¾è®­ç»ƒ': {
                title: 'è‡ªæˆ‘æ”¾æ¾è®­ç»ƒ (Autogenic Training)',
                steps: [
                    '1. èººä¸‹æˆ–åä¸‹ï¼Œä¿æŒæ”¾æ¾ã€‚',
                    '2. é»˜å¿µï¼šâ€œæˆ‘çš„å³è‡‚éå¸¸æ²‰é‡ã€‚â€å¹¶é›†ä¸­ç²¾ç¥æ„Ÿå—ã€‚',
                    '3. é»˜å¿µï¼šâ€œæˆ‘çš„åŒè…¿éå¸¸æ¸©æš–ã€‚â€æ„Ÿå—è¡€æ¶²æµæ·Œã€‚',
                    '4. ä¾æ¬¡å®Œæˆèº«ä½“å„éƒ¨ä½çš„æ²‰é‡æ„Ÿå’Œæ¸©æš–æ„Ÿã€‚æœ€åé»˜å¿µï¼šâ€œæˆ‘å®Œå…¨å¹³é™ã€‚â€'
                ],
                tip: 'ä¸€ç§è‡ªæˆ‘å‚¬çœ æŠ€æœ¯ï¼Œé€šè¿‡æƒ³è±¡èº«ä½“çš„æ„Ÿè§‰æ¥è¯±å¯¼æ·±åº¦æ”¾æ¾ï¼Œå¯¹æ²»ç–—å¤±çœ å’Œé™å‹éå¸¸æœ‰æ•ˆã€‚'
            },
            'å¤ªæ/æ°”åŠŸ': {
                title: 'å¤ªæ/æ°”åŠŸ (æ…¢åŠ¨ä½œ)',
                steps: [
                    '1. ç«™ç«‹æˆ–ååœ¨ä¸€ä¸ªèˆ’é€‚çš„ä½ç½®ã€‚',
                    '2. ç»ƒä¹ ç¼“æ…¢ã€åœ†æ¶¦ã€è¿ç»­çš„åŠ¨ä½œï¼ˆå¦‚èµ·åŠ¿ã€äº‘æ‰‹ï¼‰ã€‚',
                    '3. å°†å‘¼å¸ä¸åŠ¨ä½œå®Œå…¨åŒæ­¥ï¼ŒåŠ¨ä½œæ…¢æ—¶å‘¼å¸æ·±é•¿ã€‚',
                    '4. æŒç»­ 15-30 åˆ†é’Ÿï¼Œæ³¨é‡èº«ä½“çš„å¹³è¡¡ä¸åè°ƒã€‚'
                ],
                tip: 'ä½å†²å‡»è¿åŠ¨èƒ½ç¨³å®šå¿ƒç‡ï¼Œç»“åˆè…¹å¼å‘¼å¸ï¼Œæœ‰åŠ©äºé•¿æœŸç¨³å®šè¡€å‹ã€‚'
            }
        };

        // --- çŠ¶æ€ç®¡ç† ---
        const STORAGE_KEY = 'anxiety_tracker_data_v3'; // æ›´æ–°ç‰ˆæœ¬å·
        let entries = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
        let chartInstance = null;

        // --- UI äº‹ä»¶ç»‘å®š ---
        const methodSelect = document.getElementById('methodSelect');
        const customMethodInput = document.getElementById('customMethodInput');
        const instructionModal = document.getElementById('instructionModal');

        // ç»‘å®šæ»‘å—æ•°å€¼æ˜¾ç¤º
        ['anxietyBefore', 'anxietyAfter'].forEach(id => {
            const el = document.getElementById(id);
            const display = document.getElementById(`val-${id.replace(/[A-Z]/g, l => '-' + l.toLowerCase())}`);
            el.addEventListener('input', (e) => {
                display.textContent = e.target.value;
                if(id === 'anxietyAfter') {
                    display.className = e.target.value < 4 
                        ? "text-lg font-bold text-sage-600 leading-none" 
                        : "text-lg font-bold text-yellow-600 leading-none";
                }
            });
        });

        // æ–¹æ³•é€‰æ‹©è”åŠ¨ (æ˜¾ç¤ºè¾“å…¥æ¡† å’Œ å¼¹å‡ºæŒ‡å¯¼)
        methodSelect.addEventListener('change', (e) => {
            const selectedMethod = e.target.value;
            customMethodInput.classList.toggle('hidden', selectedMethod !== 'other');
            
            if (selectedMethod === 'other') {
                customMethodInput.focus();
            } else if (MethodInstructions[selectedMethod]) {
                showInstructions(selectedMethod);
            }
        });

        // æ¨¡æ€æ¡†é€»è¾‘
        function showInstructions(methodName) {
            const instruction = MethodInstructions[methodName];
            if (!instruction) return;

            document.getElementById('modalTitle').textContent = instruction.title + ' - æ­¥éª¤æŒ‡å¯¼';
            document.getElementById('modalTip').textContent = instruction.tip;
            
            const stepsHtml = instruction.steps.map((step, index) => 
                `<p class="text-sm text-slate-700 leading-relaxed"><span class="font-bold text-sage-500 mr-2">${index + 1}.</span> ${step.replace(/^\d+\.\s*/, '')}</p>`
            ).join('');
            
            document.getElementById('modalSteps').innerHTML = stepsHtml;
            instructionModal.classList.remove('hidden');
        }

        function hideInstructions() {
            instructionModal.classList.add('hidden');
        }

        // --- æ ¸å¿ƒé€»è¾‘ï¼šæ•°æ®å­˜å‚¨ä¸è®¡ç®— (åŒ v2.0) ---

        document.getElementById('trackerForm').addEventListener('submit', (e) => {
            e.preventDefault();

            let method = methodSelect.value === 'other' ? (customMethodInput.value.trim() || 'è‡ªå®šä¹‰æ–¹æ³•') : methodSelect.value;
            if (!method || method === "--- è¯·é€‰æ‹©æ”¾æ¾æ–¹æ³• ---") {
                 alert('è¯·å…ˆé€‰æ‹©æˆ–è¾“å…¥æ”¾æ¾æ–¹æ³•ï¼');
                 return;
            }

            const parseNum = (id) => {
                const val = document.getElementById(id).value;
                return val ? parseInt(val) : null;
            };

            const newEntry = {
                id: Date.now(),
                timestamp: new Date().toISOString(),
                method: method,
                sudsBefore: parseNum('anxietyBefore') || 0,
                sudsAfter: parseNum('anxietyAfter') || 0,
                hrBefore: parseNum('hrBefore'),
                hrAfter: parseNum('hrAfter'),
                bpSysBefore: parseNum('bpSysBefore'),
                bpDiaBefore: parseNum('bpDiaBefore'),
                bpSysAfter: parseNum('bpSysAfter'),
                bpDiaAfter: parseNum('bpDiaAfter'),
                notes: document.getElementById('notes').value.trim()
            };

            newEntry.sudsDrop = newEntry.sudsBefore - newEntry.sudsAfter;

            entries.unshift(newEntry);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(entries));

            resetForm();
            renderApp();
            
            // ç®€å•åé¦ˆ
            const btn = e.submitter;
            const originalText = btn.innerHTML;
            btn.innerHTML = `<i class="ph-bold ph-check"></i> å·²ä¿å­˜`;
            btn.classList.add('bg-green-600');
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.classList.remove('bg-green-600');
            }, 2000);
        });

        function resetForm() {
            document.getElementById('trackerForm').reset();
            document.getElementById('anxietyBefore').value = '5';
            document.getElementById('anxietyAfter').value = '3';
            document.getElementById('val-anxiety-before').textContent = '5';
            document.getElementById('val-anxiety-after').textContent = '3';
            methodSelect.value = "--- è¯·é€‰æ‹©æ”¾æ¾æ–¹æ³• ---";
            customMethodInput.classList.add('hidden');
        }

        // --- UI æ¸²æŸ“é€»è¾‘ (åŒ v2.0) ---

        function renderApp() {
            const hasData = entries.length > 0;
            document.getElementById('emptyState').classList.toggle('hidden', hasData);
            document.getElementById('dashboardSection').classList.toggle('hidden', !hasData);
            document.getElementById('historySection').classList.toggle('hidden', !hasData);

            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('zh-CN', { month: 'long', day: 'numeric', weekday: 'long' });

            if (hasData) {
                renderHistory();
                renderStats();
                renderChart();
            }
        }

        function renderHistory() {
            const container = document.getElementById('historyList');
            container.innerHTML = '';

            entries.slice(0, 20).forEach(entry => {
                const date = new Date(entry.timestamp);
                const timeStr = date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
                const dateStr = date.toLocaleDateString('zh-CN', { month: '2-digit', day: '2-digit' });

                let physioHtml = '';
                
                if (entry.hrBefore && entry.hrAfter) {
                    const diff = entry.hrBefore - entry.hrAfter;
                    const colorClass = diff > 0 ? 'text-sage-600' : (diff < 0 ? 'text-red-400' : 'text-slate-400');
                    physioHtml += `
                        <div class="flex justify-between items-center text-xs mt-1">
                            <span class="text-slate-400 w-12">å¿ƒç‡</span>
                            <span class="font-mono text-slate-600">${entry.hrBefore}â†’${entry.hrAfter}</span>
                            <span class="${colorClass} w-8 text-right font-medium">${diff > 0 ? 'â†“'+diff : (diff < 0 ? 'â†‘'+Math.abs(diff) : '-')}</span>
                        </div>`;
                }

                if (entry.bpSysBefore && entry.bpSysAfter) {
                    const sysDiff = entry.bpSysBefore - entry.bpSysAfter;
                    const colorClass = sysDiff > 0 ? 'text-sage-600' : 'text-slate-400';
                    
                    physioHtml += `
                        <div class="flex justify-between items-center text-xs mt-1">
                            <span class="text-slate-400 w-12">è¡€å‹</span>
                            <span class="font-mono text-slate-600 tracking-tighter">
                                ${entry.bpSysBefore}/${entry.bpDiaBefore}â†’${entry.bpSysAfter}/${entry.bpDiaAfter}
                            </span>
                            <span class="${colorClass} w-8 text-right font-medium">${sysDiff > 0 ? 'â†“' : ''}</span>
                        </div>`;
                }

                if (!physioHtml) physioHtml = '<div class="text-xs text-slate-300 italic mt-1">æœªè®°å½•ç”Ÿç†æŒ‡æ ‡</div>';

                const sudsDropBadge = entry.sudsDrop > 0 
                    ? `<span class="px-2 py-0.5 rounded-full text-[10px] font-bold bg-sage-100 text-sage-700">ä¸‹é™ ${entry.sudsDrop} ç‚¹</span>`
                    : `<span class="px-2 py-0.5 rounded-full text-[10px] font-bold bg-slate-100 text-slate-500">æŒå¹³/ç•¥å‡</span>`;


                const html = `
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-all">
                        <div class="flex flex-col md:flex-row gap-4">
                            <div class="flex items-center md:items-start gap-3 md:w-1/3 shrink-0">
                                <div class="w-10 h-10 rounded-full bg-sage-50 flex items-center justify-center text-xl shrink-0">
                                    ${getMethodIcon(entry.method)}
                                </div>
                                <div>
                                    <h4 class="font-bold text-slate-700 text-sm leading-tight mb-0.5">${entry.method}</h4>
                                    <p class="text-xs text-slate-400">${dateStr} ${timeStr}</p>
                                    ${entry.notes ? `<p class="text-xs text-slate-500 mt-1 bg-slate-50 p-1.5 rounded line-clamp-2">${entry.notes}</p>` : ''}
                                </div>
                            </div>

                            <div class="flex-1 border-t md:border-t-0 md:border-l border-slate-100 pt-3 md:pt-0 md:pl-4 flex flex-col justify-center">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-xs font-bold text-slate-400 uppercase">ç„¦è™‘åº¦ (SUDs)</span>
                                    ${sudsDropBadge}
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden flex">
                                        <div class="bg-slate-300 h-full" style="width: ${entry.sudsBefore * 10}%"></div>
                                    </div>
                                    <i class="ph-bold ph-arrow-right text-slate-300 text-xs"></i>
                                    <div class="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden flex">
                                        <div class="bg-sage-500 h-full" style="width: ${entry.sudsAfter * 10}%"></div>
                                    </div>
                                </div>
                                <div class="flex justify-between text-xs text-slate-500 mt-1 font-mono">
                                    <span>${entry.sudsBefore}</span>
                                    <span>${entry.sudsAfter}</span>
                                </div>
                            </div>

                            <div class="md:w-1/3 border-t md:border-t-0 md:border-l border-slate-100 pt-3 md:pt-0 md:pl-4">
                                <div class="text-[10px] font-bold text-slate-400 uppercase mb-1">ç”Ÿç†å˜åŒ–</div>
                                ${physioHtml}
                            </div>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', html);
            });
        }

        function renderStats() {
            const methodStats = {};

            entries.forEach(e => {
                if (!methodStats[e.method]) {
                    methodStats[e.method] = { count: 0, totalDrop: 0, method: e.method };
                }
                methodStats[e.method].count++;
                methodStats[e.method].totalDrop += e.sudsDrop;
            });

            const ranking = Object.values(methodStats)
                .map(item => ({
                    ...item,
                    avgDrop: (item.totalDrop / item.count).toFixed(1)
                }))
                .filter(item => item.count >= 1 && item.avgDrop > 0)
                .sort((a, b) => b.avgDrop - a.avgDrop)
                .slice(0, 3);

            const container = document.getElementById('leaderboardContainer');
            container.innerHTML = '';

            ranking.forEach((item, index) => {
                const html = `
                    <div class="bg-sage-50/50 border border-sage-100 p-4 rounded-xl flex items-center justify-between relative overflow-hidden">
                        <div class="absolute -right-4 -top-4 text-6xl opacity-10 select-none">${getMethodIcon(item.method)}</div>
                        <div>
                            <div class="text-xs text-sage-600 font-bold mb-1">No.${index + 1} æ¨è</div>
                            <div class="font-bold text-slate-700 truncate max-w-[100px] sm:max-w-full">${item.method}</div>
                            <div class="text-[10px] text-slate-400 mt-1">å·²ç»ƒä¹  ${item.count} æ¬¡</div>
                        </div>
                        <div class="text-right z-10">
                            <div class="text-xl font-bold text-sage-600">-${item.avgDrop}</div>
                            <div class="text-[10px] text-sage-400">å¹³å‡é™å¹…</div>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', html);
            });
            if(ranking.length === 0) {
                 container.innerHTML = '<div class="col-span-full text-center py-4 text-slate-400 text-sm">ç›®å‰è¿˜æ²¡æœ‰äº§ç”Ÿç§¯ææ•ˆæœçš„æ•°æ®ï¼Œç»§ç»­å°è¯•ï¼</div>';
            }
        }

        function renderChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            const chartData = [...entries].reverse().slice(-15);
            
            const labels = chartData.map(e => {
                const d = new Date(e.timestamp);
                return `${d.getMonth()+1}/${d.getDate()}`;
            });
            const dataBefore = chartData.map(e => e.sudsBefore);
            const dataAfter = chartData.map(e => e.sudsAfter);

            if (chartInstance) chartInstance.destroy();

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'æ”¾æ¾å‰',
                            data: dataBefore,
                            borderColor: '#cbd5e1',
                            borderWidth: 2,
                            borderDash: [4, 4],
                            pointRadius: 0,
                            pointHoverRadius: 4,
                            tension: 0.3
                        },
                        {
                            label: 'æ”¾æ¾å',
                            data: dataAfter,
                            borderColor: '#38b0a0',
                            backgroundColor: 'rgba(56, 176, 160, 0.05)',
                            borderWidth: 2,
                            fill: true,
                            pointBackgroundColor: '#fff',
                            pointBorderColor: '#38b0a0',
                            pointRadius: 4,
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#1e293b',
                            bodyColor: '#475569',
                            borderColor: '#e2e8f0',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true,
                            boxWidth: 8,
                            callbacks: {
                                afterBody: function(tooltipItems) {
                                    const index = tooltipItems[0].dataIndex;
                                    const entry = chartData[index];
                                    let lines = [];
                                    if(entry.hrBefore && entry.hrAfter) {
                                        const hrDrop = entry.hrBefore - entry.hrAfter;
                                        lines.push(`å¿ƒç‡: ${entry.hrBefore}â†’${entry.hrAfter} (${hrDrop > 0 ? 'â†“'+hrDrop : (hrDrop < 0 ? 'â†‘'+Math.abs(hrDrop) : 'æ— å˜åŒ–')})`);
                                    }
                                    if(entry.bpSysBefore && entry.bpSysAfter) {
                                        lines.push(`è¡€å‹: ${entry.bpSysBefore}/${entry.bpDiaBefore}â†’${entry.bpSysAfter}/${entry.bpDiaAfter}`);
                                    }
                                    return lines.length ? '\n\nâ€” ç”Ÿç†æ•°æ® â€”\n' + lines.join('\n') : '';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 10,
                            grid: { color: '#f8fafc' },
                            ticks: { font: {size: 10}, stepSize: 2 }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { font: {size: 10}, maxRotation: 0 }
                        }
                    }
                }
            });
        }

        function getMethodIcon(method) {
            if (method.includes('å‘¼å¸')) return 'ğŸŒ¬ï¸';
            if (method.includes('è‚Œè‚‰')) return 'ğŸ’ª';
            if (method.includes('å†¥æƒ³')) return 'ğŸ§˜';
            if (method.includes('ç‘œä¼½')) return 'ğŸ¤¸';
            if (method.includes('è¿åŠ¨')) return 'ğŸƒ';
            if (method.includes('ä¹¦å†™')) return 'âœï¸';
            if (method.includes('éŸ³ä¹')) return 'ğŸ§';
            if (method.includes('æ„è±¡')) return 'ğŸï¸';
            if (method.includes('è‡ªæˆ‘æ”¾æ¾')) return 'ğŸ˜´';
            if (method.includes('å¤ªæ') || method.includes('æ°”åŠŸ')) return 'â˜¯ï¸';
            return 'âœ¨';
        }

        function clearAllData() {
            // ä½¿ç”¨ window.confirm() ä»£æ›¿è‡ªå®šä¹‰æ¨¡æ€æ¡†ï¼Œç®€åŒ–ä»£ç 
            const confirmation = window.confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰å†å²è®°å½•å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚');
            if(confirmation) {
                localStorage.removeItem(STORAGE_KEY);
                entries = [];
                renderApp();
            }
        }

        // é¦–æ¬¡åŠ è½½åº”ç”¨
        renderApp();
    </script>
</body>
</html>
